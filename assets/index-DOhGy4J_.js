import{h as N}from"./kaplay-CpR_OpMc.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))d(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const g of s.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&d(g)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function d(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();const a=48,F=64,A=4,G=[210,60,60],P=[255,230,0],T=[120,200,255],D=[255,190,80],C=5,U=160,B=420,_=520,y=[{background:[12,22,70],ground:{y:230,height:28,color:[110,80,60]},platforms:[{pos:[240,185],size:[90,16],color:[200,160,80]},{pos:[420,145],size:[110,16],color:[205,175,90]},{pos:[560,115],size:[90,16],color:[210,180,100]}],traps:[{pos:[240,214],size:[60,18]},{pos:[380,214],size:[60,18]}],boostPads:[{pos:[140,214],size:[40,10],force:520},{pos:[320,214],size:[40,10],force:540}]},{background:[22,48,32],ground:{y:250,height:38,color:[70,130,70]},platforms:[{pos:[220,200],size:[110,18],color:[90,160,90]},{pos:[380,165],size:[120,18],color:[110,180,110]},{pos:[540,205],size:[80,18],color:[120,200,120]}],traps:[{pos:[150,234],size:[80,20]},{pos:[310,234],size:[60,20]},{pos:[470,234],size:[80,20]}],boostPads:[{pos:[260,234],size:[36,10],force:560},{pos:[400,234],size:[36,10],force:600}]},{background:[40,18,55],ground:{y:220,height:34,color:[140,70,120]},platforms:[{pos:[170,180],size:[80,16],color:[200,110,170]},{pos:[300,140],size:[100,16],color:[210,130,180]},{pos:[440,120],size:[100,16],color:[215,140,190]},{pos:[580,155],size:[80,16],color:[220,150,200]}],traps:[{pos:[210,204],size:[60,18]},{pos:[330,204],size:[60,18]},{pos:[470,204],size:[80,18]}],boostPads:[{pos:[280,204],size:[36,10],force:600},{pos:[560,204],size:[36,10],force:640}]},{background:[60,18,18],ground:{y:200,height:40,color:[160,70,50]},platforms:[{pos:[210,165],size:[110,18],color:[210,120,80]},{pos:[340,125],size:[100,18],color:[220,130,90]},{pos:[480,115],size:[120,18],color:[230,150,110]},{pos:[600,155],size:[80,18],color:[240,170,130]}],traps:[{pos:[140,184],size:[70,22]},{pos:[280,184],size:[60,22]},{pos:[400,184],size:[60,22]},{pos:[520,184],size:[80,22]}],boostPads:[{pos:[240,184],size:[36,10],force:620},{pos:[360,184],size:[36,10],force:660}]},{background:[18,40,70],ground:{y:215,height:36,color:[90,90,120]},platforms:[{pos:[160,180],size:[90,16],color:[150,170,210]},{pos:[280,140],size:[100,16],color:[160,190,220]},{pos:[420,110],size:[120,16],color:[170,200,230]},{pos:[560,150],size:[100,16],color:[180,210,240]}],traps:[{pos:[180,198],size:[60,18]},{pos:[330,198],size:[60,18]},{pos:[480,198],size:[60,18]}],boostPads:[{pos:[260,198],size:[36,10],force:640},{pos:[410,198],size:[36,10],force:680}]},{background:[72,18,50],ground:{y:205,height:42,color:[180,60,100]},platforms:[{pos:[180,170],size:[100,18],color:[230,120,150]},{pos:[320,130],size:[110,18],color:[240,140,170]},{pos:[460,130],size:[110,18],color:[245,150,190]},{pos:[600,170],size:[100,18],color:[250,160,210]}],traps:[{pos:[130,190],size:[70,20]},{pos:[270,190],size:[70,20]},{pos:[410,190],size:[70,20]},{pos:[550,190],size:[70,20]}],boostPads:[{pos:[220,190],size:[34,10],force:700},{pos:[360,190],size:[34,10],force:720},{pos:[500,190],size:[34,10],force:740}]}];function X(e,r){r.livesText||(r.livesText=e.add([e.pos(16,16),e.anchor("topleft"),e.fixed(),e.text("Lives: "+r.lives,{size:18}),e.color(255,255,255)])),x(r)}function x(e){e.livesText&&(e.livesText.text=`Lives: ${Math.max(e.lives,0)}`)}function K(e,r,o){r.progressText||(r.progressText=e.add([e.pos(e.width()-16,16),e.anchor("topright"),e.fixed(),e.text("",{size:18}),e.color(255,255,255)])),L(r,o)}function L(e,r){e.progressText&&(e.progressText.text=`Stage ${e.currentSection+1} / ${r}`)}function Y(e,r,o){function d(i,m={}){const u=e.clamp(i,0,y.length-1);o.currentSection=u,o.hasFinished=!1,o.isRespawning=!1,o.sectionObjects.forEach(t=>t.destroy()),o.sectionObjects=[],o.finishBanner&&(o.finishBanner.destroy(),o.finishBanner=null);const l=y[u],[j,v,O]=l.background;e.setBackground(e.rgb(j,v,O));const S=e.add([e.pos(0,l.ground.y),e.rect(e.width(),l.ground.height),e.color(...l.ground.color),e.area(),e.body({isStatic:!0}),e.anchor("topleft")]);if(o.sectionObjects.push(S),l.platforms?.forEach(t=>{const f=t.color??[170,170,170],E=e.add([e.pos(...t.pos),e.rect(...t.size),e.color(...f),e.area(),e.body({isStatic:!0}),e.anchor("center")]);o.sectionObjects.push(E)}),l.traps?.forEach(t=>{const f=t.color??G,E=e.add(["trap",e.pos(...t.pos),e.rect(...t.size),e.color(...f),e.area(),e.anchor("topleft")]);o.sectionObjects.push(E)}),l.boostPads?.forEach(t=>{const f=e.add(["boost",e.pos(...t.pos),e.rect(...t.size),e.color(...t.color??D),e.area(),e.body({isStatic:!0}),e.anchor("topleft"),{boostForce:t.force??_}]);o.sectionObjects.push(f)}),u===0){const t=e.add([e.pos(a-20,l.ground.y-6),e.rect(80,12),e.color(...P),e.anchor("center")]);o.sectionObjects.push(t);const f=e.add([e.pos(a+20,l.ground.y-50),e.anchor("center"),e.text("START",{size:20}),e.color(...P)]);o.sectionObjects.push(f)}if(u===y.length-1){const t=e.add(["finish",e.pos(e.width()-a,l.ground.y),e.rect(16,l.ground.height+160),e.anchor("botleft"),e.color(...T),e.area()]);o.sectionObjects.push(t);const f=e.add([e.pos(e.width()-a+40,l.ground.y-120),e.anchor("center"),e.text("FINISH",{size:20}),e.color(...T)]);o.sectionObjects.push(f)}X(e,o),K(e,o,y.length);const w=m.entry==="left"?a:m.entry==="right"?e.width()-a:e.clamp(r.pos.x,a,e.width()-a),I=l.ground.y-F;r.pos=e.vec2(w,I),r.vel=e.vec2(0,0),r.gravityScale=1,m.entry==="left"?r.angle=0:m.entry==="right"&&(r.angle=180)}function n(){o.hasFinished||(o.hasFinished=!0,r.vel=e.vec2(0,0),r.pos.x=e.width()-a-24,o.finishBanner=e.add([e.pos(e.width()/2,80),e.anchor("center"),e.text("Level Complete!",{size:28}),e.color(255,255,255)]))}function s(){o.hasFinished=!0,o.isRespawning=!1,r.vel=e.vec2(0,0),r.gravityScale=0,o.finishBanner&&o.finishBanner.destroy(),o.finishBanner=e.add([e.pos(e.width()/2,e.height()/2),e.anchor("center"),e.text("Game Over",{size:32}),e.color(255,80,80)]),x(o),L(o,y.length)}function g(){if(!(o.hasFinished||o.isRespawning)){if(o.isRespawning=!0,o.lives-=1,o.lives<=0){o.lives=0,x(o),s();return}x(o),L(o,y.length),d(0,{entry:"left"})}}function z(){o.lives=C,o.hasFinished=!1,o.isRespawning=!1,o.finishBanner&&(o.finishBanner.destroy(),o.finishBanner=null),x(o),L(o,y.length),d(0,{entry:"left"})}return{loadSection:d,respawnToStart:g,handleFinish:n,handleGameOver:s,resetGame:z}}function $(){return{currentSection:0,sectionObjects:[],hasFinished:!1,finishBanner:null,lives:C,livesText:null,isRespawning:!1,progressText:null}}const p=N();function H(){const e=document.createElement("style");e.textContent=`
    .joystick-container {
      position: fixed;
      left: 24px;
      bottom: 24px;
      width: 140px;
      height: 140px;
      touch-action: none;
      user-select: none;
      pointer-events: auto;
      z-index: 10;
      opacity: 0.85;
    }
    .joystick-base {
      position: relative;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid rgba(255, 255, 255, 0.3);
      backdrop-filter: blur(6px);
    }
    .joystick-stick {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 64px;
      height: 64px;
      margin-left: -32px;
      margin-top: -32px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.4);
      border: 2px solid rgba(255, 255, 255, 0.8);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
      transition: transform 0.1s ease;
      touch-action: none;
    }
    @media (pointer: fine) {
      .joystick-container {
        display: none;
      }
    }
  `,document.head.append(e);const r=document.createElement("div");r.className="joystick-container";const o=document.createElement("div");o.className="joystick-base";const d=document.createElement("div");d.className="joystick-stick",o.append(d),r.append(o),document.body.append(r);const n=60,s={active:!1,pointerId:null,x:0,y:0,jumpReady:!0,reset:()=>{s.active=!1,s.pointerId=null,s.x=0,s.y=0,s.jumpReady=!0,d.style.transform="translate(0px, 0px)"}};function g(i,m){const u=o.getBoundingClientRect(),l=u.left+u.width/2,j=u.top+u.height/2,v=i-l,O=m-j,S=Math.min(Math.hypot(v,O),n),w=Math.atan2(O,v),I=Math.cos(w)*S,t=Math.sin(w)*S;d.style.transform=`translate(${I}px, ${t}px)`,s.x=I/n,s.y=t/n}o.addEventListener("pointerdown",i=>{s.pointerId===null&&(i.preventDefault(),o.setPointerCapture(i.pointerId),s.active=!0,s.pointerId=i.pointerId,g(i.clientX,i.clientY))}),o.addEventListener("pointermove",i=>{!s.active||i.pointerId!==s.pointerId||(i.preventDefault(),g(i.clientX,i.clientY))});function z(i){i.pointerId===s.pointerId&&(i.preventDefault(),o.releasePointerCapture(i.pointerId),s.reset())}return o.addEventListener("pointerup",z),o.addEventListener("pointercancel",z),o.addEventListener("pointerout",i=>{i.pointerId===s.pointerId&&z(i)}),window.addEventListener("blur",()=>{s.reset()}),s}p.loadRoot("./");p.loadSprite("pacman","sprites/pacman.png",{sliceX:4,anims:{chomp:{from:0,to:3,speed:12,loop:!0}}});p.setGravity(1200);const c=p.add([p.pos(120,80),p.sprite("pacman",{anim:"chomp"}),p.anchor("center"),p.area(),p.body()]),b=$(),{loadSection:R,respawnToStart:M,handleFinish:J,resetGame:q}=Y(p,c,b);R(b.currentSection);const h=H();c.onCollide("trap",()=>{M()});c.onCollide("finish",()=>{J()});c.onCollide("boost",e=>{const r=e.boostForce??_;c.jump(r),c.angle=-20});p.onUpdate(()=>{if(b.hasFinished){c.vel.x=0;return}let e=0;if(p.isKeyDown("left")&&(e-=1),p.isKeyDown("right")&&(e+=1),h.active&&(e+=h.x,e=Math.max(-1,Math.min(1,e))),c.vel.x=e*U,e>.1?c.angle=0:e<-.1&&(c.angle=e<0?180:0),h.active&&(h.y<-.6&&h.jumpReady&&c.isGrounded()?(c.jump(B),h.jumpReady=!1,c.angle=-20):h.y>-.3&&(h.jumpReady=!0)),c.pos.x>p.width()+a){if(b.currentSection<y.length-1){R(b.currentSection+1,{entry:"left"});return}c.pos.x=p.width()-a}else if(c.pos.x<-a){if(b.currentSection>0){R(b.currentSection-1,{entry:"right"});return}c.pos.x=a}c.pos.y>p.height()+F*A&&M()});p.onKeyPress(["up","space"],()=>{c.isGrounded()&&c.jump(B)});p.onKeyPress("r",()=>{q(),h.reset()});
//# sourceMappingURL=index-DOhGy4J_.js.map
